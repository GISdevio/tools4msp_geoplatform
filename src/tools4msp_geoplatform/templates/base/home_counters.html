{% load i18n %}

<section class="home-counter-section py-5">
  <div class="container text-center px-4">

    <!-- Titolo e sottotitolo -->
    <div class="mb-5">
      <h2 style="font-size:36px; font-weight:700; color:#001f3f; font-family:'Lato', sans-serif; margin-bottom:1rem;">
        {% trans "Statistiche" %}
      </h2>
      <p style="font-size:18px; font-weight:500; color:#003366; font-family:'Lato', sans-serif; margin-bottom:3rem;">
        {% trans "Scopri i numeri chiave della piattaforma" %}
      </p>
    </div>

    <!-- DEBUG: counters = {{ counters|length|default:"0" }} items -->
    <!-- Icone e numeri -->
    <div class="row justify-content-center g-5">
      {% comment %} Assumiamo counters con 4 tuple: icon, value, label, url {% endcomment %}
      {% for icon, value, label, url in counters %}
      <div class="col-6 col-md-3 text-center">
        <a href="{{ url }}">
          <i class="fa {{ icon }} fa-5x mb-3" style="color:#004080;"></i>
        </a>
        <h3 class="counter" data-target="{{ value }}">0</h3>
        <p>{% trans label %}</p>
      </div>
      {% endfor %}
    </div>

  </div>
</section>


<style>
.home-counter-section {
  background: #f8f9fa;
  padding-top: 60px; 
  padding-bottom: 60px; 
}

.counter {
  font-size: 3rem;
  font-weight: 700;
  margin-bottom: 1.5rem;
}

.row .col-6.col-md-3 p {
  font-family: 'Lato', sans-serif;
  color: #001f3f;
  font-size: 1.2rem;
  margin: 0;
  font-weight: 500;
}

.row .col-6.col-md-3 h3.counter {
  font-family: 'Lato', sans-serif;
  color: #001f3f;
  font-size: 2.2rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
}

.row .col-6.col-md-3 i {
  transition: transform 0.6s ease;
}

.row .col-6.col-md-3:hover i {
  transform: rotate(20deg);
}
</style>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const counters = document.querySelectorAll(".counter");
  const targets = Array.from(counters).map(c => +c.getAttribute("data-target"));
  const duration = 2000;
  const start = performance.now();
  const easeOutCubic = t => 1 - Math.pow(1 - t, 3);

  const animate = (time) => {
    const progress = Math.min((time - start) / duration, 1);
    counters.forEach((counter, i) => {
      counter.innerText = Math.floor(easeOutCubic(progress) * targets[i]).toLocaleString();
    });
    if (progress < 1) requestAnimationFrame(animate);
  };
  requestAnimationFrame(animate);
});

</script>

